"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[147],{5352:function(e,t,n){var r=n(85893),o=n(67294),a=n(99017),s=n(82010),c=n(33299),l=n(78543),i=n(3176);t.Z=function(e){var t;let{show:n,setShow:u}=e,d=()=>u(!1),{data:h}=(0,c.useSession)(),[f,m]=(0,o.useState)([]),p=null==h?void 0:null===(t=h.user)||void 0===t?void 0:t.userId;(0,o.useEffect)(()=>{if(p&&n){let e=[(0,i.Gg)().then(e=>e.json()),(0,i.f3)().then(e=>e.json())];Promise.all(e).then(e=>{let[t,n]=e,r=t.map(e=>({title:e.title,url:"".concat("/agent","?cache=").concat(e.id),timestamp:new Date(e.updatedAt).getTime(),queries:[]})),o=n.map(e=>({title:e.title,url:"".concat("/search","?cache=").concat(e.id),timestamp:new Date(e.updatedAt).getTime(),queries:[]})),a=[...r,...o];a.sort((e,t)=>t.timestamp-e.timestamp),m(a)})}},[p,n]);let[x,b]=(0,o.useState)(!1);(0,o.useEffect)(()=>{b(!0)},[]);let g=(e,t)=>{l.n.track("Click Thread History",{threadTitle:f[e].title,url:t}),window.location.href=t},y=e=>{if(window.confirm("Are you sure you wish to delete this item?")){l.n.track("Delete individual thread");let t=f[e],n=t.url.split("=")[1];(0,i.do)(n).then(()=>{let t=[...f];t.splice(e,1),m(t)})}},w=()=>{p&&window.confirm("Are you sure you wish to clear your history?")&&(0,i.do)().then(()=>{window.location.href="/"})},j=()=>{window.location.href="/"},{resolvedTheme:v}=(0,s.F)(),k="dark"===v?"#575a7b":"#e6f0fd",[N,S]=(0,o.useState)({});return(0,r.jsx)(a.Z,{show:n,onHide:d,children:(0,r.jsx)(a.Z.Dialog,{className:"d-flex align-items-center justify-content-center m-0 vh-90",style:{minWidth:"98%",maxWidth:"150%",borderRadius:"100px"},children:(0,r.jsxs)(a.Z.Body,{className:"bg-white border border-history-panel rounded-2 pt-4 px-7",children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,r.jsx)(a.Z.Title,{className:"p-0 fs-4",children:"History"}),(0,r.jsx)("button",{className:"btn btn-sm fs-3",type:"submit",onClick:d,children:(0,r.jsx)("i",{className:"mx-2 fe fe-x darkmode-img"})})]}),x&&!!f.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"col mt-3",style:{borderBottom:"1px solid ".concat(k)}}),(0,r.jsx)("div",{className:"container p-0",style:{overflowY:"scroll",maxHeight:"65vh"},children:f.map((e,t)=>{let{title:n,url:o,timestamp:a}=e,s=new Date(a).toLocaleString();return(0,r.jsx)("div",{className:"col mt-2",style:t===f.length-1?{}:{borderBottom:"1px solid ".concat(k)},children:(0,r.jsx)("div",{className:"card shadow-none transparent-card",onClick:()=>g(t,o),children:(0,r.jsxs)("div",{className:"card-body p-4 fs-4",onMouseEnter:e=>{e.currentTarget.style.color="#687DED",e.currentTarget.style.cursor="pointer",S(e=>({...e,[t]:!0}))},onMouseLeave:e=>{e.currentTarget.style.color="",e.currentTarget.style.cursor="default",S(e=>({...e,[t]:!1}))},children:[n.substring(0,256),N[t]&&(0,r.jsx)("div",{style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)"},children:(0,r.jsx)("i",{className:"fe fe-trash m-1",onClick:e=>{e.stopPropagation(),y(t)}})}),(0,r.jsx)("div",{className:"fs-6",children:s})]})})},"".concat(a))})}),(0,r.jsxs)("div",{style:{position:"absolute",right:35,bottom:0},children:[(0,r.jsxs)("button",{className:"btn fs-5 p-0 my-4 mx-2 fw-bold text-dark",type:"button",onClick:()=>{w()},children:[(0,r.jsx)("i",{className:"fe fe-trash m-2"}),"Clear conversations"]}),(0,r.jsxs)("button",{className:"btn fs-5 p-0 my-4 mx-2 fw-bold text-dark",type:"button",onClick:()=>{j()},children:[(0,r.jsx)("i",{className:"fe fe-plus m-2"}),"New thread"]})]})]}),x&&!h&&(0,r.jsx)("p",{className:"m-0",children:"Please sign in to view your chat history."})]})})})}},37870:function(e,t,n){var r=n(85893),o=n(67294),a=n(12372),s=n(96769),c=n(65629);function l(e){let{placeholder:t,initialQuestionFromCache:n,defaultNumRowsToShow:l,customSearchHandler:i,children:u,initialContext:d,loading:h,maxTokenLimit:f=a.M9}=e,[m,p]=(0,o.useState)(n),[x,b]=(0,o.useState)(d),[g,y]=(0,o.useState)(!!d),w=(0,o.useRef)(null),j=(0,o.useRef)(null);function v(e){if(null==e?void 0:e.current){let t=e.current;t.style.height="auto";let n=Math.min(t.scrollHeight,512);t.style.height="".concat(n,"px")}}(0,o.useEffect)(()=>{v(w),v(j)},[w,m,j,x]);let k=e=>{"Tab"===e.key&&y(!0),e.shiftKey&&"Enter"===e.key||"Enter"!==e.key||(e.preventDefault(),N(e))},N=async e=>{if(e.preventDefault(),h)return;let t=m.trim(),n=x?"&c=".concat(encodeURIComponent(x)):"";if(""!==t){if(C>=a.$x){let e=(0,s.yF)(t,f),n=(0,s.yF)(x,f-(0,s.In)(e));localStorage.setItem("long-question",e),localStorage.setItem("long-context",n)}i?await i(t,x):C>=a.$x?window.location.href="/search?source=searchbox":window.location.href="/search?q=".concat(encodeURIComponent(m)).concat(n,"&source=searchbox")}},S=e=>{let t=e.target.value;p(t),t.length>=64&&y(!0)},C=m.length+x.length,I=(0,s.In)("".concat(m,"\n").concat(x));return(0,r.jsxs)("form",{className:"mb-3",onSubmit:e=>N(e),children:[(0,r.jsxs)("div",{className:"input-group shadow darkmode-light position-relative search-bar-input-group",children:[(0,r.jsx)("div",{style:{content:'""',position:"absolute",top:"-4px",left:"-5px",right:"-5px",bottom:"-4px",zIndex:"-1",background:"linear-gradient(to right, #ED6E61, #6359E1)",borderRadius:"13px"}}),(0,r.jsx)("textarea",{tabIndex:0,ref:w,autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",name:"q",className:"form-control bg-white darkmode-light searchbox-textarea search-bar-hide-scrollbar",rows:l,placeholder:t,"aria-label":t,style:{resize:"none",height:"auto",borderRadius:"10px"},onKeyDown:k,onChange:S,value:m}),(0,r.jsxs)("div",{className:"btn-group shadow-none bg-white-grey",style:{borderRadius:"10px"},children:[(0,r.jsx)(c.Z,{message:"Advanced Search",children:(0,r.jsx)("button",{className:"btn p-2 rounded-0",type:"button",onClick:()=>{x||y(!g)},children:g||x?(0,r.jsx)("i",{className:"fe fe-chevron-up text-black"}):(0,r.jsx)("i",{className:"fe fe-chevron-down text-black"})})}),(0,r.jsx)("button",{className:"btn p-2 rounded-0",type:"submit",children:(0,r.jsx)("i",{className:"fe fe-search text-black"})}),I>64&&(0,r.jsx)("button",{className:"fs-6 text-dark",type:"button",style:{position:"absolute",bottom:"0",right:"0",background:"none",border:"none",cursor:"none",WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",zIndex:100},disabled:!0,children:(0,r.jsxs)("div",{className:I>=f?"text-danger":"text-dark",children:[I,"/",f," ",I>=f&&"(will be truncated)"]})})]})]}),g&&(0,r.jsx)("div",{className:"input-group shadow darkmode-light mt-5",children:(0,r.jsx)("textarea",{tabIndex:0,ref:j,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",name:"c",className:"form-control bg-white darkmode-light searchbox-textarea",rows:l,placeholder:"Put any extra code or context here.","aria-label":t,style:{resize:"none",height:"auto"},onKeyDown:k,onChange:e=>{b(e.target.value)},value:x})}),u]})}l.defaultProps={customSearchHandler:null,children:null,loading:!1,maxTokenLimit:a.M9},t.Z=l},96769:function(e,t,n){n.d(t,{$j:function(){return x},Ih:function(){return p},In:function(){return g},Mz:function(){return s},N6:function(){return c},N7:function(){return b},Uj:function(){return a},V7:function(){return h},XD:function(){return f},Yg:function(){return d},_P:function(){return l},hC:function(){return i},xs:function(){return u},yF:function(){return y}});var r=n(21870),o=n(12372);async function*a(e){let t=e.getReader();try{for(;;){let{done:e,value:n}=await t.read();if(e)return;yield n}}catch(e){console.error(e)}finally{t.releaseLock()}}let s=(e,t)=>{let n=e.getReader();return new ReadableStream({async start(e){for(;;){if(t.aborted){n.cancel(),e.error(new DOMException("Aborted","AbortError"));return}try{let{done:t,value:r}=await n.read();if(t){e.close();return}e.enqueue(r)}catch(t){e.error(t);return}}}})},c=(e,t,n)=>{let r=[...e];return t>=r.length&&r.push(n),r[t]=n,r},l=e=>new URL(e).hostname,i=e=>!!e&&""!==e&&-1!==e.indexOf("!")&&-1!==e.indexOf("!os"),u=e=>{if(!e||""===e||-1===e.indexOf("!"))return null;let t=Object.values(o.RW);t.sort((e,t)=>t.shortcut.length-e.shortcut.length);let n=e.split(" ");for(let r=0;r<t.length;r+=1){let{shortcut:o,url:a}=t[r],s="!".concat(o),c="".concat(o,"!");if(-1!==n.indexOf(s)){let t=e.replace(s,""),n="".concat(a).concat(encodeURIComponent(t));return n}if(-1!==n.indexOf(c)){let t=e.replace(c,""),n="".concat(a).concat(encodeURIComponent(t));return n}}return null},d=(e,t)=>e.replace(/[\(\[]Source\s*\d+(,\s*Source\s*\d+)*[\)\]](?!\()|\[\^\d+\^\]|(\[\^[a-z0-9]+\.[\w-]+(\.[\w-]+)*\^\])/gi,(e,n)=>{let r=e.match(/\d+/g);if(!r)return console.error("no source numbers",e),e;let o=r.map(e=>parseInt(e,10)),a=o.map(e=>{if(t&&e<t.length){let n=t[e];return n}return""}),s=a.filter(e=>e),c=s.map((e,t)=>"[[".concat(r[t],"]](").concat(e,")"));return c.join(" ")}),h=/Source (\d+)/g,f=(e,t)=>{let n="".concat(e,"\n").concat(t);n.length>o.$x?window.location.href="/agent?source=searchbox":(g(n)>o.CZ&&(n=y(n,o.CZ)),window.location.href="/agent?q=".concat(encodeURIComponent(n),"&source=searchbox"))},m=(e,t)=>{let n={...e};return Object.keys(t).forEach(e=>{Object.keys(n).includes(e)?"object"==typeof t[e]?n[e]=m(n[e],t[e]):n[e]+=t[e]:n[e]=t[e]}),n},p=(e,t)=>{let n=t.id,{delta:r}=t.choices[0];if(Object.keys(e).includes(n)){let t=m(e[n].choices[0].delta,r);return{...e,[n]:{...e[n],choices:[{delta:t}]}}}return{...e,[n]:t}},x=e=>Object.values(e).sort((e,t)=>e.created-t.created).map(e=>{let{delta:t}=e.choices[0],{role:n,content:r,function_call:o,name:a,metadata:s}=t,c=null==s?void 0:s.web_results,l={role:n,content:r,functionCall:o,name:a,metadata:{...s,webResults:c}};return l}),b=(e,t)=>t?"Phind Plus"===e?o.de:"Phind Pro"===e||"Phind Pro Yearly"===e?o.Ln:o.BY:o.BY;function g(e){return r.ZP.encode(e,{disallowedSpecial:new Set}).length}function y(e,t){let n=r.ZP.encode(e,{disallowedSpecial:new Set});return r.ZP.decode(n.splice(0,t))}},91745:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(67294);function o(e,t){let[n,o]=(0,r.useState)(t);return(0,r.useEffect)(()=>{let n=localStorage.getItem(e);null===n?"function"==typeof t?o(t()):o(t):o(JSON.parse(n))},[]),(0,r.useEffect)(()=>{localStorage.setItem(e,JSON.stringify(n))},[n]),[n,o]}}}]);